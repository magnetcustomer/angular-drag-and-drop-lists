/**
 * angular-drag-and-drop-lists v2.1.0
 *
 * Copyright (c) 2014 Marcel Juenemann marcel@juenemann.cc
 * Copyright (c) 2014-2017 Google Inc.
 * https://github.com/marceljuenemann/angular-drag-and-drop-lists
 *
 * License: MIT
 */
!function(e){function n(e,n){return"all"===n?e:e.filter(function(e){return-1!==n.toLowerCase().indexOf(e)})}var t="application/x-dnd",r="application/json",a="Text",d=["move","copy","link"]
e.directive("dndDraggable",["$parse","$timeout",function(e,i){return function(l,f,g){f.attr("draggable","true"),g.dndDisableIf&&l.$watch(g.dndDisableIf,function(e){f.attr("draggable",!e)}),f.on("dragstart",function(s){var c=window.getSelection()
if(c.rangeCount>1)return c.removeAllRanges(),!1
if(s=s.originalEvent||s,"false"===f.attr("draggable"))return!1
if(void 0!==f.attr("dnd-nodrag")&&!s._dndHandle)return!1
o.isDragging=!0,o.itemType=g.dndType&&l.$eval(g.dndType).toLowerCase(),o.dropEffect="none",o.effectAllowed=l.$eval(g.dndEffectAllowed)||d[0],s.dataTransfer.effectAllowed=o.effectAllowed
var u=l.$eval(g.dndDraggable),p=t+(o.itemType?"-"+o.itemType:"")
try{s.dataTransfer.setData(p,angular.toJson(u))}catch(e){var v=angular.toJson({item:u,type:o.itemType})
try{s.dataTransfer.setData(r,v)}catch(e){var D=n(d,o.effectAllowed)
s.dataTransfer.effectAllowed=D[0],s.dataTransfer.setData(a,v)}}if(f.addClass("dndDragging"),i(function(){f.addClass("dndDraggingSource")},0),s._dndHandle&&s.dataTransfer.setDragImage){var y=f[0].querySelectorAll("[dnd-handle]")[0],h=(y?y.offsetLeft:0)+s.offsetX,T=(y?y.offsetHeight:0)+s.offsetY
s.dataTransfer.setDragImage(f[0],h,T)}if(e(g.dndDragstart)(l,{event:s}),g.dndCallback){var m=e(g.dndCallback)
o.callback=function(e){return m(l,e||{})}}s.stopPropagation()}),f.on("dragend",function(n){n=n.originalEvent||n,l.$apply(function(){var t=o.dropEffect
e(g[{copy:"dndCopied",link:"dndLinked",move:"dndMoved",none:"dndCanceled"}[t]])(l,{event:n}),e(g.dndDragend)(l,{event:n,dropEffect:t})}),o.isDragging=!1,o.callback=void 0,f.removeClass("dndDragging"),f.removeClass("dndDraggingSource"),n.stopPropagation(),i(function(){f.removeClass("dndDraggingSource")},0)}),f.on("click",function(n){g.dndSelected&&(n=n.originalEvent||n,l.$apply(function(){e(g.dndSelected)(l,{event:n})}),n.stopPropagation())}),f.on("selectstart",function(){this.dragDrop&&this.dragDrop()})}}]),e.directive("dndList",["$parse",function(e){return function(i,l,f){function g(e){e=e.originalEvent||e
var n=s(e.dataTransfer.types),t=c(n)
if(!n||!u(t))return!0
if(T.parentNode!==m&&l.append(h),e.target!==m){for(var r=e.target;r.parentNode!==m&&r.parentNode;)r=r.parentNode
if(r.parentNode===m&&r!==T){var d,o=r.getBoundingClientRect()
d=b.horizontal?e.clientX<o.left+o.width/2:e.clientY<o.top+o.height/2,d?r.previousSibling!==T&&m.insertBefore(T,r):r.nextSibling!==T&&m.insertBefore(T,r.nextSibling)}}var i=n===a,g=p(e,i)
return"none"===g?v():f.dndDragover&&!D(f.dndDragover,e,g,t)?v():(e.preventDefault(),i||(e.dataTransfer.dropEffect=g),l.addClass("dndDragover"),e.stopPropagation(),!1)}function s(e){if(!e)return a
for(var n=0;n<e.length;n++)if(e[n]===a||e[n]===r||e[n].substr(0,t.length)===t)return e[n]
return null}function c(e){return o.isDragging?o.itemType||void 0:e===a||e===r?null:e&&e.substr(t.length+1)||void 0}function u(e){return!b.disabled&&(!(!b.externalSources&&!o.isDragging)&&(!b.allowedTypes||null===e||e&&-1!==b.allowedTypes.indexOf(e)))}function p(e,t){var r=d
return t||(r=n(r,e.dataTransfer.effectAllowed)),o.isDragging&&(r=n(r,o.effectAllowed)),f.dndEffectAllowed&&(r=n(r,f.dndEffectAllowed)),r.length?e.ctrlKey&&-1!==r.indexOf("copy")?"copy":e.altKey&&-1!==r.indexOf("link")?"link":r[0]:"none"}function v(){return h.remove(),l.removeClass("dndDragover"),!0}function D(n,t,r,a,d,l){return e(n)(i,{callback:o.callback,dropEffect:r,event:t,external:!o.isDragging,index:void 0!==d?d:y(),item:l||void 0,type:a})}function y(){return Array.prototype.indexOf.call(m.children,T)}var h=function(){var e
return angular.forEach(l.children(),function(n){var t=angular.element(n)
t.hasClass("dndPlaceholder")&&(e=t)}),e||angular.element("<li class='dndPlaceholder'></li>")}()
h.remove()
var T=h[0],m=l[0],b={}
l.on("dragenter",function(e){e=e.originalEvent||e
var n=f.dndAllowedTypes&&i.$eval(f.dndAllowedTypes)
b={allowedTypes:angular.isArray(n)&&n.join("|").toLowerCase().split("|"),disabled:f.dndDisableIf&&i.$eval(f.dndDisableIf),externalSources:f.dndExternalSources&&i.$eval(f.dndExternalSources),horizontal:f.dndHorizontalList&&i.$eval(f.dndHorizontalList)}
var t=s(e.dataTransfer.types)
if(!t||!u(c(t)))return!0
e.preventDefault()}),l.on("dragover",_.throttle(g,50,{leading:!0,trailing:!1})),l.on("drop",function(e){e=e.originalEvent||e
var n=s(e.dataTransfer.types),t=c(n)
if(!n||!u(t))return!0
e.preventDefault()
try{var d=JSON.parse(e.dataTransfer.getData(n))}catch(e){return v()}if((n===a||n===r)&&(t=d.type||void 0,d=d.item,!u(t)))return v()
var l=n===a,g=p(e,l)
if("none"===g)return v()
var h=y()
return f.dndDrop&&!(d=D(f.dndDrop,e,g,t,h,d))?v():(o.dropEffect=g,l||(e.dataTransfer.dropEffect=g),!0!==d&&i.$apply(function(){i.$eval(f.dndList).splice(h,0,d)}),D(f.dndInserted,e,g,t,h,d),v(),e.stopPropagation(),!1)}),l.on("dragleave",function(e){e=e.originalEvent||e
var n=document.elementFromPoint(e.clientX,e.clientY)
m.contains(n)&&!e._dndPhShown?e._dndPhShown=!0:v()})}}]),e.directive("dndNodrag",function(){return function(e,n,t){n.attr("draggable","true"),n.on("dragstart",function(e){e=e.originalEvent||e,e._dndHandle||(e.dataTransfer.types&&e.dataTransfer.types.length||e.preventDefault(),e.stopPropagation())}),n.on("dragend",function(e){e=e.originalEvent||e,e._dndHandle||e.stopPropagation()})}}),e.directive("dndHandle",function(){return function(e,n,t){n.attr("draggable","true"),n.on("dragstart dragend",function(e){e=e.originalEvent||e,e._dndHandle=!0})}})
var o={}}(angular.module("dndLists",[]))
